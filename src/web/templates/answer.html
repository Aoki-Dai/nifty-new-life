{% extends 'layout.html' %}
{% block title %}
  解答ページ
{% endblock %}
{% block content %}

  <body style="background-color: pink">
    <div id="form_page" style="background-color: white; position:relative; height:900px; top: -30px;">
      <submit id="post">
        <div id="company_name">
          <img src="{{ url_for('static', filename='nifty_new_life_logo (2).png') }}" style="width: 300px; position: relative; left:10%; top:20px;">
        </div>
        <!-- タイトル -->

        <h2 style="position: relative; left:130px">{{ thread.title }}</h2>
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="https://setsuzoku.nifty.com/" style="position:relative; left:130px;">光ファイバー</a>
            <!--<a class="nav-link" href="{{ url_for('app.auth.signup') }}">タグ1</a>-->
            <!--<a href="{{ url_for('app.top_page') }}" class="btn btn-primary mb-4">新しいトップページへ</a>-->
          </li>
        </ul>
        <h2 style="position:relative; left:130px;">質問内容：</h2>
        <p style="position:relative; left:130px; width: 1040px;">{{ thread.description }}</p>
        <h2 style="position:relative; left:130px;">回答：</h2>
        {% for answer in answers %}
          <div style="position:relative; left:130px; width: 1040px; margin-bottom: 20px; border: 1px solid #ddd; padding: 10px;">
            <p>{{ answer.description }}</p>
          </div>
        {% endfor %}

        <form id="form" action="/api/v1/create_new_answer/{{thread.thread_id}}" method="post">
          <input type="number" name="user_id" placeholder="user_id" style="top:10px; position:relative; left:130px;"/>
          <br>
          <textarea type="text" name="description" placeholder="answer" style="top:10px; position:relative; width: 1040px; left:130px; height:300px;"></textarea>
          <button type="button" class="btn btn-primary btn-lg" btn-primary="btn-primary" btn-lg”="btn-lg”" id="post_btn" style="top:10px; position:relative; width: 1040px; left:130px;">回答する</button>
        </form>
        <script>
          function get_data() {
            console.log('post_btn clicked');
            const user_id = document
              .getElementsByName('user_id')[0]
              .value
              console
              .log(user_id);
            const description = document
              .getElementsByName('description')[0]
              .value;
            console.log(description);
            return JSON.stringify({description, user_id})
          }
          //const form = document
          //  .getElementById("form")
          //  .addEventListener('',)
          const submitButton = document.getElementById("post_btn")

          submitButton.onclick = () => {
            data = get_data()
            const action = form.getAttribute("action")
            const options = {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: data
            }
            fetch(action, options).then((e) => {
              if (e.status === 200) {
                alert("保存しました。")
                return
              }
              alert(`Error: ${e.message}`);
            })
          }
        </script>
        <submit>
          <br><br>
          <a href="{{ url_for('app.my_top_page') }}" style="position: relative; left:10%; top: 20px;">トップページに戻る</a>
        </body>
      {% endblock %}